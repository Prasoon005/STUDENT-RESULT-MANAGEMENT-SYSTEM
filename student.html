<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f4f4f4; 
            margin: 0; 
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .container { 
            background-color: #fff; 
            padding: 40px; 
            border-radius: 8px; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); 
            width: 80%; 
            max-width: 800px;
        }

        h2 { 
            text-align: center; 
            color: #333; 
            font-size: 32px; 
            margin-bottom: 20px; 
        }

        h3 { 
            text-align: center; 
            color: #666; 
            font-size: 24px; 
            margin-bottom: 30px; 
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 16px;
        }

        th {
            background-color: #4CAF50;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .result {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }

        .pass {
            color: green;
        }

        .fail {
            color: red;
        }

        .button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 30px;
            text-decoration: none;
            text-align: center;
        }

        .button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Student Portal</h2>
    <h3>Your Results</h3>

    <div id="studentResults">
        <!-- Results Table -->
        <table>
            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Result</th>
                    <th>Grade</th>
                </tr>
            </thead>
            <tbody id="resultTableBody">
                <!-- Dynamic Data will be inserted here -->
            </tbody>
        </table>

        <!-- Pass/Fail Result -->
        <div id="passFailResult" class="result"></div>
    </div>

    <a href="index.html" class="button">Back to Index</a>
</div>

<script>
    // Assuming that the logged-in student's name is stored in localStorage
    let users = JSON.parse(localStorage.getItem('users')) || [];
    const studentName = localStorage.getItem('loggedInStudent'); // Get logged-in student from localStorage
    const student = users.find(user => user.name === studentName && user.role === "student");

    const resultTableBody = document.getElementById("resultTableBody");
    const passFailResult = document.getElementById("passFailResult");

    // Grade function based on percentage
    function getGrade(marks) {
        if (marks >= 90) {
            return "A";
        } else if (marks >= 80) {
            return "B";
        } else if (marks >= 70) {
            return "C";
        } else if (marks >= 50) {
            return "D";
        } else {
            return "F";
        }
    }

    if (student && student.results.length > 0) {
        // Display the results in the table
        student.results.forEach(result => {
            const row = resultTableBody.insertRow();
            row.insertCell(0).textContent = result.subject;
            row.insertCell(1).textContent = result.studentResult;
            row.insertCell(2).textContent = getGrade(parseInt(result.studentResult)); // Assign grade based on result
        });

        // Calculate the total marks and display pass/fail result
        const totalMarks = student.results.length * 100; // Assume each subject is out of 100
        const obtainedMarks = student.results.reduce((total, result) => total + parseInt(result.studentResult), 0);
        const percentage = (obtainedMarks / totalMarks) * 100;

        // Display pass or fail based on the percentage
        if (percentage >= 50) {
            passFailResult.textContent = "Pass";
            passFailResult.classList.add("pass");
        } else {
            passFailResult.textContent = "Fail";
            passFailResult.classList.add("fail");
        }
    } else {
        // If no results are available for the student
        resultTableBody.innerHTML = "<tr><td colspan='3'>No results available.</td></tr>";
        passFailResult.textContent = "No results to display.";
    }
</script>

</body>
</html>
